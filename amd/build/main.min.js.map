{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["import $ from 'jquery';\nimport ModalForm from 'core_form/modalform';\nimport {getString} from 'core/str';\nimport Templates from 'core/templates';\nimport Notification from 'core/notification';\nimport ModalDeleteCancel from 'core/modal_delete_cancel';\n\n\nconst addItem = root => {\n    const triggerElement = root.find('#add_material');\n    triggerElement.off();\n    triggerElement.on('click', event => {\n        event.preventDefault();\n\n        const modalForm = new ModalForm({\n            modalConfig: {\n                title: getString('form_title', 'block_class_material'),\n            },\n            formClass: 'block_class_material\\\\form\\\\add_material',\n            saveButtonText: getString('save', 'block_class_material'),\n            returnFocus: triggerElement,\n        });\n\n        modalForm.addEventListener(modalForm.events.SUBMIT_BUTTON_PRESSED, event => {\n            event.preventDefault();\n            $('input[name=\"cmid\"]').val(Number(root.data('course-module-id')));\n\n            if(modalForm.validateElements()) {\n                modalForm.submitFormAjax();\n            }\n        });\n\n        modalForm.show();\n\n        modalForm.addEventListener(modalForm.events.FORM_SUBMITTED, async event => {\n            await drawItem(root, event.detail);\n            Notification.addNotification({\n                message: getString('upload_success', 'block_class_material'),\n                type: 'success',\n                closebutton: true,\n                annouce: true,\n            });\n        });\n    });\n};\n\nconst drawItem = async (root, data) => {\n    const fileItemTemplate = await Templates.render('block_class_material/file-item', data);\n    root.find('.document-container').append(fileItemTemplate);\n    loadActions(root);\n};\n\nconst loadActions = root => {\n    const deleteButtons = root.find('.document-item-actions-button-delete');\n\n    deleteButtons.off();\n    deleteButtons.on('click', async event => {\n        event.preventDefault();\n        const modal = await ModalDeleteCancel.create({\n            title: getString('modal_delete_document_title', 'block_class_material'),\n            body: getString('modal_delete_document_body', 'block_class_material'),\n            isVerticallyCentered: true,\n        });\n\n        modal.show();\n    });\n};\n\n\nexport const init = async (root) => {\n    addItem(root);\n    loadActions(root);\n};"],"names":["drawItem","async","root","data","fileItemTemplate","Templates","render","find","append","loadActions","deleteButtons","off","on","event","preventDefault","ModalDeleteCancel","create","title","body","isVerticallyCentered","show","triggerElement","modalForm","ModalForm","modalConfig","formClass","saveButtonText","returnFocus","addEventListener","events","SUBMIT_BUTTON_PRESSED","val","Number","validateElements","submitFormAjax","FORM_SUBMITTED","detail","addNotification","message","type","closebutton","annouce","addItem"],"mappings":"kpBA8CMA,SAAWC,MAAOC,KAAMC,cACpBC,uBAAyBC,mBAAUC,OAAO,iCAAkCH,MAClFD,KAAKK,KAAK,uBAAuBC,OAAOJ,kBACxCK,YAAYP,OAGVO,YAAcP,aACVQ,cAAgBR,KAAKK,KAAK,wCAEhCG,cAAcC,MACdD,cAAcE,GAAG,SAASX,MAAAA,QACtBY,MAAMC,wBACcC,6BAAkBC,OAAO,CACzCC,OAAO,kBAAU,8BAA+B,wBAChDC,MAAM,kBAAU,6BAA8B,wBAC9CC,sBAAsB,KAGpBC,yBAKMnB,MAAAA,OA7DJC,CAAAA,aACNmB,eAAiBnB,KAAKK,KAAK,iBACjCc,eAAeV,MACfU,eAAeT,GAAG,SAASC,QACvBA,MAAMC,uBAEAQ,UAAY,IAAIC,mBAAU,CAC5BC,YAAa,CACTP,OAAO,kBAAU,aAAc,yBAEnCQ,UAAW,2CACXC,gBAAgB,kBAAU,OAAQ,wBAClCC,YAAaN,iBAGjBC,UAAUM,iBAAiBN,UAAUO,OAAOC,uBAAuBjB,QAC/DA,MAAMC,qCACJ,sBAAsBiB,IAAIC,OAAO9B,KAAKC,KAAK,sBAE1CmB,UAAUW,oBACTX,UAAUY,oBAIlBZ,UAAUF,OAEVE,UAAUM,iBAAiBN,UAAUO,OAAOM,gBAAgBlC,MAAAA,cAClDD,SAASE,KAAMW,MAAMuB,8BACdC,gBAAgB,CACzBC,SAAS,kBAAU,iBAAkB,wBACrCC,KAAM,UACNC,aAAa,EACbC,SAAS,WA8BrBC,CAAQxC,MACRO,YAAYP"}